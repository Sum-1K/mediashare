<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Notifications - MediaShare</title>
    <link rel="stylesheet" th:href="@{/css/notifications.css}">
    <style>
        .tag-response-buttons {
            margin-top: 10px;
            display: flex;
            gap: 10px;
        }
        
        .tag-response-buttons form {
            margin: 0;
        }
        
        .tag-response-buttons .btn {
            padding: 5px 15px;
            font-size: 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
        }
        
        .btn-accept {
            background-color: #28a745;
            color: white;
        }
        
        .btn-accept:hover {
            background-color: #218838;
        }
        
        .btn-reject {
            background-color: #dc3545;
            color: white;
        }
        
        .btn-reject:hover {
            background-color: #c82333;
        }
        
        .notification-processed {
            color: #6c757d;
            font-style: italic;
        }
        
        .tag-notification {
            border-left: 3px solid #007bff;
            padding-left: 10px;
        }
    </style>
</head>
<body>
    <div class="notifications-container">
        <header class="notifications-header">
            <h1>Notifications</h1>
            <a href="/home" class="back-button">‚Üê Back to Home</a>
        </header>
        
        <div class="notifications-list" th:if="${notifications == null or notifications.isEmpty()}">
            <div class="empty-state">
                <p>No notifications yet</p>
            </div>
        </div>


        
        <div class="notifications-list" th:unless="${notifications == null or notifications.isEmpty()}">
            <div th:each="notification : ${notifications}" class="notification-item">
                <!-- Tag Notifications -->
                <div th:if="${notification.tagId != null}" class="tag-notification">
                    <div class="notification-content">
                        <p th:text="${notification.notificationContent}">You have been tagged in a post</p>
                        <small th:text="${#temporals.format(notification.createdAt, 'MMM dd, yyyy HH:mm')}"></small>
                        
                        <!-- Unread Tag Notification - Show Accept/Reject Buttons -->
                        <div th:if="${!notification.isRead}" class="tag-response-buttons">
                            <form th:action="@{/notifications/tag/respond}" method="post">
                                <input type="hidden" name="notificationId" th:value="${notification.notifId}">
                                <input type="hidden" name="action" value="accept">
                                <button type="submit" class="btn btn-accept">Accept Tag</button>
                            </form>
                            <form th:action="@{/notifications/tag/respond}" method="post">
                                <input type="hidden" name="notificationId" th:value="${notification.notifId}">
                                <input type="hidden" name="action" value="reject">
                                <button type="submit" class="btn btn-reject">Reject Tag</button>
                            </form>
                        </div>
                        
                        <!-- Read Tag Notification - Show Processed Message -->
                        <div th:if="${notification.isRead}" class="notification-processed">
                            <em>Tag request processed</em>
                        </div>
                    </div>
                    <div class="notification-actions">
                        <span class="notification-type">üè∑Ô∏è Tag</span>
                    </div>
                </div>
                
                <!-- Like Notifications -->
                <div th:if="${notification.likeId != null}" class="notification-content">
                    <p th:text="${notification.notificationContent}"></p>
                    <small th:text="${#temporals.format(notification.createdAt, 'MMM dd, yyyy HH:mm')}"></small>
                    <div class="notification-actions">
                        <span class="notification-type">‚ù§Ô∏è Like</span>
                    </div>
                </div>
                
                <!-- Comment Notifications -->
                <div th:if="${notification.commentId != null}" class="notification-content">
                    <p th:text="${notification.notificationContent}"></p>
                    <small th:text="${#temporals.format(notification.createdAt, 'MMM dd, yyyy HH:mm')}"></small>
                    <div class="notification-actions">
                        <span class="notification-type">üí¨ Comment</span>
                    </div>
                </div>
                
                <!-- Follow Request Notifications -->
                <div th:if="${notification.followRequestId != null}" class="notification-content">
                    <p th:text="${notification.notificationContent}"></p>
                    <small th:text="${#temporals.format(notification.createdAt, 'MMM dd, yyyy HH:mm')}"></small>
                    <div class="notification-actions">
                        <span class="notification-type">üë§ Follow Request</span>
                    </div>
                </div>
                
                <!-- Chat Notifications -->
                <div th:if="${notification.chatId != null}" class="notification-content">
                    <p th:text="${notification.notificationContent}"></p>
                    <small th:text="${#temporals.format(notification.createdAt, 'MMM dd, yyyy HH:mm')}"></small>
                    <div class="notification-actions">
                        <span class="notification-type">üíå Message</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>