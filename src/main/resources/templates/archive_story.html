<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Archived Stories</title>
    <link rel="stylesheet" href="/css/archive_story.css">

</head>
<body>
    <h1>Archived Stories</h1>

    <div class="story-grid">
        <div class="story-card" th:each="story : ${stories}">
            <img th:src="@{${story.mediaFile}}" alt="story media">
            <p th:text="${story.highlightTopic}">Story Topic</p>

            <!-- Highlight toggle checkbox -->
        <label>
            <input type="checkbox" class="highlight-checkbox"
                   th:data-story-id="${story.storyId}"
                   th:checked="${story.isHighlighted}">
            Highlight
        </label>
        </div>
    </div>

    <script>
document.addEventListener('DOMContentLoaded', () => {
    const checkboxes = document.querySelectorAll('.highlight-checkbox');

    checkboxes.forEach(cb => {
        cb.addEventListener('change', (event) => {
            const storyId = cb.dataset.storyId;
            const newValue = cb.checked;

            fetch('/stories/highlight', {
                method: 'POST',
                headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                body: `storyId=${storyId}&isHighlighted=${newValue}`
            })
            .then(response => response.text())
            .then(msg => {
                console.log('Highlight updated:', msg);
            })
            .catch(err => console.error('Error updating highlight:', err));
        });
    });
});
</script>

</body>
</html>
